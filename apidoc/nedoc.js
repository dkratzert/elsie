$(function() {
    var NEDOC_MODULES = JSON.parse('[["Arrow", "elsie.shapes.arrow", true], ["Backend", "elsie.render.backends.backend", true], ["Box", "elsie.boxtree.box", true], ["BoxItem", "elsie.boxtree.boxitem", true], ["BoxMixin", "elsie.boxtree.boxmixin", true], ["ExternPdfSlide", "elsie.slides.slide", true], ["ExternalMerger", "elsie.render.pdfmerge", true], ["FsCache", "elsie.utils.cache", true], ["InkscapeBackend", "elsie.render.backends.svg.backend", true], ["InkscapeShell", "elsie.render.inkscape", true], ["Layout", "elsie.boxtree.layout", true], ["LazyPoint", "elsie.boxtree.lazy", true], ["LazyValue", "elsie.boxtree.lazy", true], ["ListBuilder", "elsie.ext.list", true], ["MarkdownContext", "elsie.ext.markdown", true], ["MyFormatter", "elsie.text.highlight", true], ["PdfRenderUnit", "elsie.render.render", true], ["PosValue", "elsie.boxtree.value", true], ["PyPdfMerger", "elsie.render.pdfmerge", true], ["Rect", "elsie.utils.geom", true], ["RenderUnit", "elsie.render.render", true], ["RenderingContext", "elsie.render.backends.rcontext", true], ["ShowInfo", "elsie.slides.show", true], ["SimpleBoxItem", "elsie.boxtree.boxitem", true], ["SizeValue", "elsie.boxtree.value", true], ["Slide", "elsie.slides.slide", true], ["SlideDeck", "elsie.slides.slidedeck", true], ["StyleContainer", "elsie.text.stylecontainer", true], ["SvgRenderUnit", "elsie.render.render", true], ["SvgRenderingContext", "elsie.render.backends.svg.rcontext", true], ["TextBoxItem", "elsie.text.textboxitem", true], ["TextStyle", "elsie.text.textstyle", true], ["Xml", "elsie.utils.sxml", true], ["__enter__", "elsie.ext.list.ListBuilder", false], ["__eq__", "elsie.utils.geom.Rect", false], ["__exit__", "elsie.ext.list.ListBuilder", false], ["__init__", "elsie.boxtree.box.Box", false], ["__init__", "elsie.boxtree.boxitem.BoxItem", false], ["__init__", "elsie.boxtree.boxitem.SimpleBoxItem", false], ["__init__", "elsie.boxtree.layout.Layout", false], ["__init__", "elsie.boxtree.lazy.LazyPoint", false], ["__init__", "elsie.boxtree.lazy.LazyValue", false], ["__init__", "elsie.boxtree.value.PosValue", false], ["__init__", "elsie.boxtree.value.SizeValue", false], ["__init__", "elsie.ext.list.ListBuilder", false], ["__init__", "elsie.ext.markdown.MarkdownContext", false], ["__init__", "elsie.render.backends.rcontext.RenderingContext", false], ["__init__", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["__init__", "elsie.render.backends.svg.rcontext.SvgRenderingContext", false], ["__init__", "elsie.render.inkscape.InkscapeShell", false], ["__init__", "elsie.render.pdfmerge.ExternalMerger", false], ["__init__", "elsie.render.pdfmerge.PyPdfMerger", false], ["__init__", "elsie.render.render.PdfRenderUnit", false], ["__init__", "elsie.render.render.RenderUnit", false], ["__init__", "elsie.render.render.SvgRenderUnit", false], ["__init__", "elsie.shapes.arrow.Arrow", false], ["__init__", "elsie.slides.show.ShowInfo", false], ["__init__", "elsie.slides.slide.ExternPdfSlide", false], ["__init__", "elsie.slides.slide.Slide", false], ["__init__", "elsie.slides.slidedeck.SlideDeck", false], ["__init__", "elsie.text.highlight.MyFormatter", false], ["__init__", "elsie.text.stylecontainer.StyleContainer", false], ["__init__", "elsie.text.textboxitem.TextBoxItem", false], ["__init__", "elsie.text.textstyle.TextStyle", false], ["__init__", "elsie.utils.cache.FsCache", false], ["__init__", "elsie.utils.geom.Rect", false], ["__init__", "elsie.utils.sxml.Xml", false], ["__repr__", "elsie.boxtree.value.SizeValue", false], ["__repr__", "elsie.slides.show.ShowInfo", false], ["__repr__", "elsie.utils.geom.Rect", false], ["_apply_name_policy", "elsie.slides.slidedeck.SlideDeck", false], ["_box_children", "elsie.boxtree.box.Box", false], ["_check_bool", "elsie.text.textstyle", false], ["_check_choice", "elsie.text.textstyle", false], ["_check_number", "elsie.text.textstyle", false], ["_check_string", "elsie.text.textstyle", false], ["_check_visibility", "elsie.render.ora", false], ["_children_to_svg", "elsie.render.ora", false], ["_close", "elsie.utils.sxml.Xml", false], ["_create_box", "elsie.ext.list.ListBuilder", false], ["_create_simple_box_item", "elsie.boxtree.boxmixin.BoxMixin", false], ["_create_sublist", "elsie.ext.list.ListBuilder", false], ["_debug_paint", "elsie.boxtree.box.Box", false], ["_draw", "elsie.ext.latex", false], ["_ensure_steps", "elsie.boxtree.box.Box", false], ["_full_path", "elsie.utils.cache.FsCache", false], ["_get_block_end_index", "elsie.text.textparser", false], ["_get_box", "elsie.boxtree.box.Box", false], ["_get_box", "elsie.boxtree.boxitem.BoxItem", false], ["_get_box", "elsie.boxtree.boxmixin.BoxMixin", false], ["_get_filename", "elsie.utils.cache.FsCache", false], ["_image_bitmap", "elsie.boxtree.boxmixin.BoxMixin", false], ["_image_ora", "elsie.boxtree.boxmixin.BoxMixin", false], ["_image_svg", "elsie.boxtree.boxmixin.BoxMixin", false], ["_layer_to_svg", "elsie.render.ora", false], ["_load_query_cache", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["_make_query", "elsie.text.textboxitem.TextBoxItem", false], ["_min_steps", "elsie.boxtree.box.Box", false], ["_open_blocks", "elsie.text.textparser", false], ["_open_blocks_count", "elsie.text.textparser", false], ["_query_cache_file", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["_render_latex", "elsie.ext.latex", false], ["_render_svg", "elsie.boxtree.boxmixin.BoxMixin", false], ["_repr_html_", "elsie.boxtree.box.Box", false], ["_repr_html_", "elsie.slides.slide.Slide", false], ["_save_query_cache", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["_set_padding", "elsie.boxtree.layout", false], ["_show_progress", "elsie.slides.slidedeck.SlideDeck", false], ["_stack_to_svg", "elsie.render.ora", false], ["_text_box_helper", "elsie.text.textboxitem.TextBoxItem", false], ["_text_helper", "elsie.boxtree.boxmixin.BoxMixin", false], ["_tokens_merge_helper", "elsie.text.textparser", false], ["_traverse", "elsie.boxtree.box.Box", false], ["add", "elsie.boxtree.layout.Layout", false], ["add", "elsie.boxtree.lazy.LazyPoint", false], ["add", "elsie.boxtree.lazy.LazyValue", false], ["add_callback", "elsie.boxtree.layout.Layout", false], ["add_child", "elsie.boxtree.box.Box", false], ["add_line_numbers", "elsie.text.textparser", false], ["add_pdf", "elsie.slides.slidedeck.SlideDeck", false], ["align", "elsie.text.textstyle.TextStyle", false], ["align", "elsie.text.textstyle.TextStyle", false], ["append", "elsie.render.pdfmerge.ExternalMerger", false], ["append", "elsie.render.pdfmerge.PyPdfMerger", false], ["apply_rotation", "elsie.render.backends.svg.utils", false], ["arabic_digit_render_fn", "elsie.ext.list", false], ["arrow", "elsie.shapes", true], ["backend", "elsie.render.backends", true], ["backend", "elsie.render.backends.svg", true], ["backends", "elsie.render", true], ["bold", "elsie.text.textstyle.TextStyle", false], ["bold", "elsie.text.textstyle.TextStyle", false], ["box", "elsie.boxtree", true], ["box", "elsie.boxtree.boxmixin.BoxMixin", false], ["box", "elsie.slides.slide.Slide", false], ["boxitem", "elsie.boxtree", true], ["boxmixin", "elsie.boxtree", true], ["boxtree", "elsie", true], ["build", "elsie.ext.markdown", false], ["build_blank_line", "elsie.ext.markdown", false], ["build_children", "elsie.ext.markdown", false], ["build_fenced_code", "elsie.ext.markdown", false], ["build_heading", "elsie.ext.markdown", false], ["build_list_top", "elsie.ext.markdown", false], ["build_paragraph", "elsie.ext.markdown", false], ["build_quote", "elsie.ext.markdown", false], ["build_text", "elsie.ext.markdown", false], ["cache", "elsie.utils", true], ["check_and_unpack_path_commands", "elsie.shapes.path", false], ["close", "elsie.render.inkscape.InkscapeShell", false], ["close", "elsie.utils.sxml.Xml", false], ["code", "elsie.boxtree.boxmixin.BoxMixin", false], ["color", "elsie.text.textstyle.TextStyle", false], ["color", "elsie.text.textstyle.TextStyle", false], ["compose", "elsie.text.textstyle.TextStyle", false], ["compose_style", "elsie.text.textstyle", false], ["compute", "elsie.boxtree.value.PosValue", false], ["compute", "elsie.boxtree.value.SizeValue", false], ["compute_query", "elsie.render.backends.svg.query", false], ["compute_size_request", "elsie.boxtree.layout.Layout", false], ["compute_text_width", "elsie.render.backends.backend.Backend", false], ["compute_text_width", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["compute_text_x", "elsie.render.backends.backend.Backend", false], ["compute_text_x", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["convert_ora_to_svg", "elsie.render.ora", false], ["convert_to_pdf", "elsie.render.inkscape.InkscapeShell", false], ["copy", "elsie.ext.markdown.MarkdownContext", false], ["copy", "elsie.text.textstyle.TextStyle", false], ["copy", "elsie.utils.geom.Rect", false], ["create_image_data", "elsie.render.image", false], ["create_render_unit", "elsie.render.backends.backend.Backend", false], ["create_render_unit", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["create_root_md_box", "elsie.ext.markdown", false], ["current_fragment", "elsie.boxtree.box.Box", false], ["current_fragment", "elsie.slides.slide.Slide", false], ["draw", "elsie.boxtree.boxitem.BoxItem", false], ["draw", "elsie.render.backends.svg", true], ["draw_bitmap", "elsie.render.backends.rcontext.RenderingContext", false], ["draw_bitmap", "elsie.render.backends.svg.draw", false], ["draw_bitmap", "elsie.render.backends.svg.rcontext.SvgRenderingContext", false], ["draw_ellipse", "elsie.render.backends.rcontext.RenderingContext", false], ["draw_ellipse", "elsie.render.backends.svg.draw", false], ["draw_ellipse", "elsie.render.backends.svg.rcontext.SvgRenderingContext", false], ["draw_polygon", "elsie.render.backends.rcontext.RenderingContext", false], ["draw_polygon", "elsie.render.backends.svg.draw", false], ["draw_polygon", "elsie.render.backends.svg.rcontext.SvgRenderingContext", false], ["draw_rect", "elsie.render.backends.rcontext.RenderingContext", false], ["draw_rect", "elsie.render.backends.svg.draw", false], ["draw_rect", "elsie.render.backends.svg.rcontext.SvgRenderingContext", false], ["draw_text", "elsie.render.backends.rcontext.RenderingContext", false], ["draw_text", "elsie.render.backends.svg.draw", false], ["draw_text", "elsie.render.backends.svg.rcontext.SvgRenderingContext", false], ["element", "elsie.utils.sxml.Xml", false], ["ellipse", "elsie.boxtree.boxmixin.BoxMixin", false], ["ensure", "elsie.boxtree.value.SizeValue", false], ["ensure", "elsie.utils.cache.FsCache", false], ["ensure_by_file", "elsie.utils.cache.FsCache", false], ["ensure_height", "elsie.boxtree.layout.Layout", false], ["ensure_steps", "elsie.slides.show.ShowInfo", false], ["ensure_width", "elsie.boxtree.layout.Layout", false], ["escape_text", "elsie.utils.sxml", false], ["eval", "elsie.boxtree.lazy.LazyPoint", false], ["eval", "elsie.boxtree.lazy.LazyValue", false], ["eval_pair", "elsie.boxtree.lazy", false], ["eval_path_commands", "elsie.shapes.path", false], ["eval_value", "elsie.boxtree.lazy", false], ["export", "elsie.render.render.PdfRenderUnit", false], ["export", "elsie.render.render.SvgRenderUnit", false], ["export_by_inkscape", "elsie.render.inkscape", false], ["ext", "elsie", true], ["extract_line", "elsie.text.textparser", false], ["fbox", "elsie.boxtree.boxmixin.BoxMixin", false], ["files", "elsie.utils", true], ["find_centroid", "elsie.utils.geom", false], ["font", "elsie.text.textstyle.TextStyle", false], ["font", "elsie.text.textstyle.TextStyle", false], ["format", "elsie.text.highlight.MyFormatter", false], ["from_label", "elsie.slides.show.ShowInfo", false], ["geom", "elsie.utils", true], ["get", "elsie.utils.cache.FsCache", false], ["get_image_steps", "elsie.render.image", false], ["get_javascript", "elsie.render.jupyter", false], ["get_painters", "elsie.boxtree.box.Box", false], ["get_pdf_merger_by_name", "elsie.render.pdfmerge", false], ["get_raw_text", "elsie.ext.markdown", false], ["get_slide_by_name", "elsie.slides.slidedeck.SlideDeck", false], ["get_slide_repr_steps", "elsie.render.jupyter", false], ["get_style", "elsie.text.stylecontainer.StyleContainer", false], ["get_svg", "elsie.render.render.RenderUnit", false], ["get_svg", "elsie.render.render.SvgRenderUnit", false], ["get_version", "elsie.render.backends.backend.Backend", false], ["get_version", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["get_version", "elsie.render.inkscape.InkscapeShell", false], ["get_width", "elsie.render.inkscape.InkscapeShell", false], ["get_x", "elsie.render.inkscape.InkscapeShell", false], ["has_style", "elsie.text.stylecontainer.StyleContainer", false], ["highlight", "elsie.text", true], ["highlight_code", "elsie.text.highlight", false], ["image", "elsie.boxtree.boxmixin.BoxMixin", false], ["image", "elsie.render", true], ["inkscape", "elsie.render", true], ["inline_box", "elsie.text.textboxitem.TextBoxItem", false], ["is_inside_notebook", "elsie.render.jupyter", false], ["is_managed", "elsie.boxtree.layout.Layout", false], ["is_visible", "elsie.slides.show.ShowInfo", false], ["italic", "elsie.text.textstyle.TextStyle", false], ["italic", "elsie.text.textstyle.TextStyle", false], ["item", "elsie.ext.list.ListBuilder", false], ["jupyter", "elsie.render", true], ["latex", "elsie.ext", true], ["latex", "elsie.ext.latex", false], ["layout", "elsie.boxtree", true], ["lazy", "elsie.boxtree", true], ["line", "elsie.boxtree.boxmixin.BoxMixin", false], ["line_box", "elsie.text.textboxitem.TextBoxItem", false], ["line_spacing", "elsie.text.textstyle.TextStyle", false], ["line_spacing", "elsie.text.textstyle.TextStyle", false], ["list", "elsie.ext", true], ["make_highlight_styles", "elsie.text.highlight", false], ["make_render_unit", "elsie.slides.slide.ExternPdfSlide", false], ["make_render_unit", "elsie.slides.slide.Slide", false], ["managed_children", "elsie.boxtree.layout.Layout", false], ["map", "elsie.boxtree.lazy.LazyValue", false], ["markdown", "elsie.ext", true], ["markdown", "elsie.ext.markdown", false], ["max_step", "elsie.slides.show.ShowInfo", false], ["md_heading_style_name", "elsie.ext.markdown", false], ["mid_point", "elsie.boxtree.boxmixin.BoxMixin", false], ["mid_point", "elsie.utils.geom.Rect", false], ["mid_x", "elsie.utils.geom.Rect", false], ["mid_y", "elsie.utils.geom.Rect", false], ["min_children_size", "elsie.boxtree.layout.Layout", false], ["min_steps", "elsie.slides.show.ShowInfo", false], ["move_end_point", "elsie.shapes.arrow.Arrow", false], ["new_slide", "elsie.slides.slidedeck.SlideDeck", false], ["normalize_tokens", "elsie.text.textparser", false], ["number_of_lines", "elsie.text.textparser", false], ["ol", "elsie.ext.list.ListBuilder", false], ["ora", "elsie.render", true], ["ordered_list", "elsie.ext.list", false], ["overlay", "elsie.boxtree.boxmixin.BoxMixin", false], ["p", "elsie.boxtree.boxmixin.BoxMixin", false], ["parse", "elsie.boxtree.value.PosValue", false], ["parse", "elsie.boxtree.value.SizeValue", false], ["parse", "elsie.slides.show.ShowInfo", false], ["parse_show_info_from_label", "elsie.render.image", false], ["parse_text", "elsie.text.textparser", false], ["path", "elsie.boxtree.boxmixin.BoxMixin", false], ["path", "elsie.shapes", true], ["path_points_for_end_arrow", "elsie.shapes.path", false], ["path_update_end_point", "elsie.shapes.path", false], ["pdfmerge", "elsie.render", true], ["per_page_grouping", "elsie.render.render", false], ["point", "elsie.boxtree.layout.Layout", false], ["polygon", "elsie.boxtree.boxmixin.BoxMixin", false], ["position", "elsie.utils.geom.Rect", false], ["prepare", "elsie.slides.slide.ExternPdfSlide", false], ["prepare", "elsie.slides.slide.Slide", false], ["process_query", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["prune_cache", "elsie.render.backends.backend.Backend", false], ["prune_cache", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["query", "elsie.render.backends.svg", true], ["raw_text", "elsie.utils.sxml.Xml", false], ["rcontext", "elsie.render.backends", true], ["rcontext", "elsie.render.backends.svg", true], ["read_helper", "elsie.utils.files", false], ["rect", "elsie.boxtree.boxmixin.BoxMixin", false], ["remove_unused", "elsie.utils.cache.FsCache", false], ["rename_ids", "elsie.render.backends.svg.utils", false], ["render", "elsie", true], ["render", "elsie.render", true], ["render", "elsie.render.backends.svg.rcontext.SvgRenderingContext", false], ["render", "elsie.shapes.arrow.Arrow", false], ["render", "elsie.slides.slidedeck.SlideDeck", false], ["render", "elsie.text.textboxitem.TextBoxItem", false], ["render_slide_html", "elsie.render.jupyter", false], ["replace_relative_steps", "elsie.slides.show", false], ["run_command", "elsie.render.inkscape.InkscapeShell", false], ["run_query", "elsie.render.inkscape.InkscapeShell", false], ["save_cache", "elsie.render.backends.backend.Backend", false], ["save_cache", "elsie.render.backends.svg.backend.InkscapeBackend", false], ["sbox", "elsie.boxtree.boxmixin.BoxMixin", false], ["scaler", "elsie.boxtree.boxmixin", false], ["segment_delta", "elsie.utils.geom", false], ["segment_len", "elsie.utils.geom", false], ["segment_resize", "elsie.utils.geom", false], ["set", "elsie.utils.sxml.Xml", false], ["set_font_from_style", "elsie.render.backends.svg.draw", false], ["set_image_size_request", "elsie.boxtree.layout.Layout", false], ["set_paint_style", "elsie.render.backends.svg.draw", false], ["set_rect", "elsie.boxtree.layout.Layout", false], ["set_style", "elsie.text.stylecontainer.StyleContainer", false], ["shapes", "elsie", true], ["show", "elsie.slides", true], ["shrink", "elsie.utils.geom.Rect", false], ["size", "elsie.text.textstyle.TextStyle", false], ["size", "elsie.text.textstyle.TextStyle", false], ["size", "elsie.utils.geom.Rect", false], ["slide", "elsie.slides", true], ["slide", "elsie.slides.slidedeck.SlideDeck", false], ["slidedeck", "elsie.slides", true], ["slides", "elsie", true], ["steps", "elsie.slides.slide.ExternPdfSlide", false], ["steps", "elsie.slides.slide.Slide", false], ["stylecontainer", "elsie.text", true], ["svg", "elsie.render.backends", true], ["svg_begin", "elsie.render.backends.svg.utils", false], ["svg_end", "elsie.render.backends.svg.utils", false], ["svg_file_input", "elsie.render.inkscape", false], ["svg_size_to_pixels", "elsie.render.backends.svg.utils", false], ["sxml", "elsie.utils", true], ["text", "elsie", true], ["text", "elsie.boxtree.boxmixin.BoxMixin", false], ["text", "elsie.utils.sxml.Xml", false], ["text_x_in_rect", "elsie.text.textboxitem", false], ["textboxitem", "elsie.text", true], ["textparser", "elsie.text", true], ["textstyle", "elsie.text", true], ["to_string", "elsie.utils.sxml.Xml", false], ["tokens_merge", "elsie.text.textparser", false], ["tokens_to_text_without_style", "elsie.text.textparser", false], ["trim_indent", "elsie.text.textparser", false], ["ul", "elsie.ext.list.ListBuilder", false], ["unordered_list", "elsie.ext.list", false], ["unpack_point", "elsie.boxtree.lazy", false], ["update", "elsie.text.textstyle.TextStyle", false], ["update_style", "elsie.text.stylecontainer.StyleContainer", false], ["utils", "elsie", true], ["utils", "elsie.render.backends.svg", true], ["value", "elsie.boxtree", true], ["variant_numeric", "elsie.text.textstyle.TextStyle", false], ["variant_numeric", "elsie.text.textstyle.TextStyle", false], ["version", "elsie", true], ["wait_for_prompt", "elsie.render.inkscape.InkscapeShell", false], ["wrap_text_with_style", "elsie.ext.markdown.MarkdownContext", false], ["write", "elsie.render.pdfmerge.ExternalMerger", false], ["write", "elsie.render.pdfmerge.PyPdfMerger", false], ["write", "elsie.utils.sxml.Xml", false], ["write_debug", "elsie.render.render.RenderUnit", false], ["write_debug", "elsie.render.render.SvgRenderUnit", false], ["x", "elsie.boxtree.boxmixin.BoxMixin", false], ["x", "elsie.boxtree.layout.Layout", false], ["x2", "elsie.utils.geom.Rect", false], ["y", "elsie.boxtree.boxmixin.BoxMixin", false], ["y", "elsie.boxtree.layout.Layout", false], ["y2", "elsie.utils.geom.Rect", false]]');
    $("#search").autocomplete({
    source: NEDOC_MODULES.map(function(i) { return { label: i[0], desc: i[1], fulllink: i[2] }; }),
    select: function(event, ui) {
        if (ui.fulllink) {
            window.location.href = ui.item.desc + "." + ui.item.label + ".html";
        } else {
            window.location.href = ui.item.desc + ".html#" + ui.item.label;
        }
    },
    }).autocomplete("instance")._renderItem = function(ul, item) {
        return $("<li>")
            .append("<div><b>" + item.label + "</b><br>" + item.desc + "</div>")
            .appendTo(ul);
    };

    $(".fexpand").on("click", function(event) {
        event.preventDefault();
        var elem = $(this);
        var parent = elem.closest(".fn");
        var fdetail = parent.children(".fdetail");
        fdetail.toggle(200, "swing", function() {
            var is_visible = fdetail.is(':visible');
            var toggle = elem.parent().children(".ftoggle");
            var toggle2 = elem.parent().children(".ftoggle-empty");
            if (is_visible) {
                toggle.html("&#9660;");
                toggle2.html("&#9661;");
            } else {
                toggle.html("&#9654;");
                toggle2.html("&#9655;");
            }
        });
    })

    if(window.location.hash) {
        var name = window.location.hash.slice(3); // remove #f_ prefix
        var elem = $("#fn_" + name);
        elem.toggle(0);
        elem.parent().parent().css("backgroundColor", "#e9f6ff");
    }
});
